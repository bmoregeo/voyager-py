import os
import sys
import unittest
sys.path.append(os.path.dirname(os.getcwd()))
from workers import base_job, oracle_worker


class TestOracleLayers(unittest.TestCase):
    """Test case for indexing Oracle layers."""
    @classmethod
    def setUpClass(self):
        pass

    def test_all_layers(self):
        """Test all layers are returned for indexing."""
        job = base_job.Job(os.path.join(os.getcwd(), 'all_layers_oracle.json'))
        job.connect_to_database()
        base_layers_to_keep = [(u'LOCK_A', u'GDB1'), (u'LOCK_L', u'GDB1'), (u'LOCK_P', u'GDB1'), (u'LOGGING_AREA_A', u'GDB1'), (u'LOG_BOOM_A', u'GDB1'), (u'MAG_DISTURB_AREA_A', u'GDB1'), (u'MARITIME_AREA_A', u'GDB1'), (u'MARITIME_AREA_L', u'GDB1'), (u'MARITIME_AREA_P', u'GDB1'), (u'MARITIME_LIMIT_BND_A', u'GDB1'), (u'MARITIME_LIMIT_BND_L', u'GDB1'), (u'MARITIME_LIMIT_BND_P', u'GDB1'), (u'MARITIME_STATION_P', u'GDB1'), (u'MARSH_A', u'GDB1'), (u'MEASURED_DIST_LINE_L', u'GDB1'), (u'MILITARY_BASE_A', u'GDB1'), (u'MILITARY_BASE_P', u'GDB1'), (u'MINERAL_PILE_A', u'GDB1'), (u'MINERAL_PILE_P', u'GDB1'), (u'MINE_A', u'GDB1'), (u'MINE_L', u'GDB1'), (u'MINE_P', u'GDB1'), (u'MISC_AIR_OBSTRUCT_A', u'GDB1'), (u'MISC_OBSTACLE_A', u'GDB1'), (u'MISC_OBSTACLE_L', u'GDB1'), (u'MISC_SURFACE_DRAIN_A', u'GDB1'), (u'MISC_VEGETATION_A', u'GDB1'), (u'MISC_VEGETATION_P', u'GDB1'), (u'MISSILE_SITE_A', u'GDB1'), (u'MOAT_L', u'GDB1'), (u'MOBILE_HOME_PARK_A', u'GDB1'), (u'MOLE_A_1', u'GDB1'), (u'MONUMENT_A_1', u'GDB1'), (u'MONUMENT_P_1', u'GDB1'), (u'MOORING_MAST_A', u'GDB1'), (u'MOORING_MAST_P', u'GDB1'), (u'MORAINE_A', u'GDB1'), (u'MOUNTAIN_PASS_P', u'GDB1'), (u'NAMED_LOCATION_A', u'GDB1'), (u'NAMED_LOCATION_L', u'GDB1'), (u'NAMED_LOCATION_P', u'GDB1'), (u'NATIVE_SETTLEMENT_A', u'GDB1'), (u'NATIVE_SETTLEMENT_P', u'GDB1'), (u'NAVAIDS_AERO_P', u'GDB1'), (u'NURSERY_A', u'GDB1'), (u'OASIS_A', u'GDB1'), (u'OASIS_P', u'GDB1'), (u'OFFSHORE_LOAD_FAC_A', u'GDB1'), (u'OFFSHORE_LOAD_FAC_L', u'GDB1'), (u'OIL_GAS_FACILITIES_A', u'GDB1'), (u'OIL_GAS_FACILITIES_P', u'GDB1'), (u'OIL_GAS_FIELD_A', u'GDB1'), (u'ORCHARD_PLANTATION_A', u'GDB1'), (u'ORCHARD_PLANTATION_L', u'GDB1'), (u'OVERFALLS_TIDE_RIP_P', u'GDB1'), (u'OVERHEAD_OBS_LOC_P', u'GDB1'), (u'OVERRUN_STOPWAY_A', u'GDB1'), (u'PACK_ICE_A', u'GDB1'), (u'PARK_A', u'GDB1'), (u'PARK_P', u'GDB1'), (u'PENSTOCK_L', u'GDB1'), (u'PERCHES_STAKES_P', u'GDB1'), (u'PIER_WHARF_QUAY_A', u'GDB1'), (u'PIER_WHARF_QUAY_L', u'GDB1'), (u'PILE_PILING_POST_A', u'GDB1'), (u'PILE_PILING_POST_P', u'GDB1'), (u'PIPELINE_PIPE_A', u'GDB1'), (u'PIPELINE_PIPE_L', u'GDB1'), (u'PLATFORM_A', u'GDB1'), (u'PLATFORM_P', u'GDB1'), (u'PLAZA_CITY_SQUARE_A', u'GDB1'), (u'POINT_OF_CHANGE_P', u'GDB1'), (u'POLAR_ICE_A', u'GDB1'), (u'POWER_PLANT_A', u'GDB1'), (u'POWER_PLANT_P', u'GDB1'), (u'POWER_TRANS_LINE_L', u'GDB1'), (u'POWER_TRANS_PYLON_P', u'GDB1'), (u'ADMINISTRATIVE_BND_A', u'GDB1'), (u'ADMINISTRATIVE_BND_L', u'GDB1'), (u'ADMIN_AREA_A', u'GDB1'), (u'ADMIN_AREA_P', u'GDB1'), (u'AERIAL_CABLE_LINE_L', u'GDB1'), (u'AERIAL_CABLE_PYLON_P', u'GDB1'), (u'AIRCRAFT_BUNKER_P', u'GDB1'), (u'AIRPORT_AIRFIELD_A', u'GDB1'), (u'AIRPORT_AIRFIELD_L', u'GDB1'), (u'AIRPORT_AIRFIELD_P', u'GDB1'), (u'AIRPORT_LIGHTING_P', u'GDB1'), (u'AIR_FAC_REF_POINT_P', u'GDB1'), (u'AIR_OBSTRUCTION_P', u'GDB1'), (u'AMUSEMENT_PARK_A', u'GDB1'), (u'AMUSEMENT_PARK_ATT_P', u'GDB1'), (u'AMUSEMENT_PARK_P', u'GDB1'), (u'ANCHORAGE_A', u'GDB1'), (u'ANCHORAGE_L', u'GDB1'), (u'ANCHORAGE_P', u'GDB1'), (u'ANIMAL_SANCTUARY_L', u'GDB1'), (u'APRON_HARDSTAND_A', u'GDB1'), (u'AQUEDUCT_A', u'GDB1'), (u'AQUEDUCT_L', u'GDB1'), (u'AQUEDUCT_P', u'GDB1'), (u'ARCHEOLOGICAL_SITE_A', u'GDB1'), (u'ARCHEOLOGICAL_SITE_P', u'GDB1'), (u'ARTIFACT_LOCATION_A', u'GDB1'), (u'ARTIFACT_LOCATION_P', u'GDB1'), (u'ASPHALT_LAKE_A', u'GDB1'), (u'ASSEMBLY_PLANT_A', u'GDB1'), (u'ATHLETIC_FIELD_A', u'GDB1'), (u'ATHLETIC_FIELD_P', u'GDB1'), (u'BAMBOO_CANE_A', u'GDB1'), (u'BASTION_RAMP_FORT_A', u'GDB1'), (u'BASTION_RAMP_FORT_L', u'GDB1'), (u'BEACH_A', u'GDB1'), (u'BEACON_P', u'GDB1'), (u'BENCHMARK_A', u'GDB1'), (u'BENCHMARK_P', u'GDB1'), (u'BERTH_P', u'GDB1'), (u'BLAST_FURNACE_P', u'GDB1'), (u'BLUFF_CLIFF_ESCARP_L', u'GDB1'), (u'BOG_A', u'GDB1'), (u'BOTTOM_CHARACTER_P', u'GDB1'), (u'BOUNDARY_MONUMENT_P', u'GDB1'), (u'BREAKERS_A', u'GDB1'), (u'BREAKERS_L', u'GDB1'), (u'BREAKERS_P', u'GDB1'), (u'BREAKWATER_A', u'GDB1'), (u'BREAKWATER_L', u'GDB1'), (u'BRIDGE_OVERPASS_A', u'GDB1'), (u'BRIDGE_OVERPASS_P', u'GDB1'), (u'BRIDGE_SPAN_L', u'GDB1'), (u'BRIDGE_SUPERSTRUCT_L', u'GDB1'), (u'BRIDGE_SUPERSTRUCT_P', u'GDB1'), (u'BRIDGE_TOWER_P', u'GDB1'), (u'BUILDING_L', u'GDB1'), (u'BUILDING_P', u'GDB1'), (u'BUILD_SUPERSTR_ADD_A', u'GDB1'), (u'BUILD_SUPERSTR_ADD_P', u'GDB1'), (u'BUILTUP_AREA_A', u'GDB1'), (u'BUOY_P', u'GDB1'), (u'CABLE_L', u'GDB1'), (u'CAIRN_P', u'GDB1'), (u'CALLINGIN_POINT_P', u'GDB1'), (u'CAMPGROUND_A', u'GDB1'), (u'CAMPGROUND_P', u'GDB1'), (u'CAMP_A', u'GDB1'), (u'CANAL_A', u'GDB1'), (u'CANAL_L', u'GDB1'), (u'CATALYTIC_CRACKER_P', u'GDB1'), (u'CAUSEWAY_A', u'GDB1'), (u'CAUSEWAY_L', u'GDB1'), (u'CAVE_P', u'GDB1'), (u'CEMETERY_A', u'GDB1'), (u'CEMETERY_P', u'GDB1'), (u'CHIMNEY_SMOKESTACK_P', u'GDB1'), (u'CISTERN_A', u'GDB1'), (u'CISTERN_P', u'GDB1'), (u'CLEARED_FIREBREAK_A', u'GDB1'), (u'CLEARED_FIREBREAK_L', u'GDB1'), (u'COASTLINE_L', u'GDB1'), (u'COAST_SHORELINE_L', u'GDB1'), (u'COMM_BUILDING_A', u'GDB1'), (u'COMM_BUILDING_L', u'GDB1'), (u'COMM_BUILDING_P', u'GDB1'), (u'COMM_TOWER_A', u'GDB1'), (u'COMM_TOWER_P', u'GDB1'), (u'COMPLEX_OUTLINE_A', u'GDB1'), (u'CONTROL_PT_STATION_P', u'GDB1'), (u'CONTROL_TOWER_A', u'GDB1'), (u'CONTROL_TOWER_P', u'GDB1'), (u'CONVEYOR_L', u'GDB1'), (u'CONVEYOR_P', u'GDB1'), (u'COOLING_TOWER_A', u'GDB1'), (u'COOLING_TOWER_P', u'GDB1'), (u'CRANE_P', u'GDB1'), (u'CREVICE_CREVASSE_A', u'GDB1'), (u'CREVICE_CREVASSE_L', u'GDB1'), (u'CRIB_P', u'GDB1'), (u'CROPLAND_A', u'GDB1'), (u'CROPLAND_L', u'GDB1'), (u'CULVERT_L', u'GDB1'), (u'CULVERT_P', u'GDB1'), (u'CURRENT_FLOW_P', u'GDB1'), (u'CUT_A', u'GDB1'), (u'CUT_L', u'GDB1'), (u'DAM_WEIR_A', u'GDB1'), (u'DAM_WEIR_L', u'GDB1'), (u'DAM_WEIR_P', u'GDB1'), (u'DEPOT_STORAGE_A', u'GDB1'), (u'DEPOT_STORAGE_P', u'GDB1'), (u'DEPRESSION_A', u'GDB1'), (u'DEPRESSION_L', u'GDB1'), (u'DEPTH_AREA_A', u'GDB1'), (u'DEPTH_CONTOUR_A', u'GDB1'), (u'DEPTH_CONTOUR_L', u'GDB1'), (u'DEPTH_CURVE_L', u'GDB1'), (u'DISK_DISH_A', u'GDB1'), (u'DISK_DISH_P', u'GDB1'), (u'DISPLAY_SIGN_P', u'GDB1'), (u'DISPOSAL_SITE_A', u'GDB1'), (u'DISPOSAL_SITE_P', u'GDB1'), (u'DITCH_A', u'GDB1'), (u'DOLPHIN_P', u'GDB1'), (u'DRAGON_TEETH_A', u'GDB1'), (u'DRAGON_TEETH_L', u'GDB1'), (u'DRIVE_IN_THEATER_A', u'GDB1'), (u'DRIVE_IN_THEAT_SCR_P', u'GDB1'), (u'DROP_GATE_P', u'GDB1'), (u'DRYDOCK_A', u'GDB1'), (u'EARLY_WARN_RADAR_A', u'GDB1'), (u'EMBANKMENT_FILL_A', u'GDB1'), (u'EMBANKMENT_FILL_L', u'GDB1'), (u'ENTRANCE_EXIT_P', u'GDB1'), (u'ESKER_L', u'GDB1'), (u'EXTRACT_REC_A', u'GDB1'), (u'FAIRGROUNDS_A', u'GDB1'), (u'FAULT_L', u'GDB1'), (u'FEED_LOT_STOCKYARD_A', u'GDB1'), (u'FEED_LOT_STOCKYARD_P', u'GDB1'), (u'FENCE_L', u'GDB1'), (u'FERRY_CROSSING_L', u'GDB1'), (u'FERRY_CROSSING_P', u'GDB1'), (u'FERRY_SITE_A', u'GDB1'), (u'FILTRATION_BEDS_A', u'GDB1'), (u'FILTRATION_BEDS_P', u'GDB1'), (u'FIRE_HYDRANT_P', u'GDB1'), (u'FIRING_RANGE_A', u'GDB1'), (u'FIRING_RANGE_P', u'GDB1'), (u'FISHING_HARBOR_P', u'GDB1'), (u'FISHING_PROME_PIER_A', u'GDB1'), (u'FISHING_PROME_PIER_L', u'GDB1'), (u'FISH_HATCHERY_FARM_A', u'GDB1'), (u'FISH_TRAPS_WEIRS_A', u'GDB1'), (u'FISH_TRAPS_WEIRS_P', u'GDB1'), (u'FLAGSTAFF_FLAGPOLE_P', u'GDB1'), (u'FLARE_PIPE_P', u'GDB1'), (u'FLOOD_BARRAGE_A', u'GDB1'), (u'FLOOD_BARRAGE_L', u'GDB1'), (u'FLUME_L', u'GDB1'), (u'FORD_L', u'GDB1'), (u'FORD_P', u'GDB1'), (u'FORESHORE_PREC_IHO_A', u'GDB1'), (u'FORESHORE_PREC_IHO_L', u'GDB1'), (u'FORESHORE_PREC_IHO_P', u'GDB1'), (u'FORTIFICATION_A', u'GDB1'), (u'FORTIFICATION_P', u'GDB1'), (u'FOUL_GROUND_A', u'GDB1'), (u'FOUL_GROUND_P', u'GDB1'), (u'FOUNTAIN_P', u'GDB1'), (u'GANTRY_P', u'GDB1'), (u'GATE_NAUTICAL_L', u'GDB1'), (u'GATE_P', u'GDB1'), (u'GAUGING_STATION_P', u'GDB1'), (u'GDB_ITEMS', u'GDB1'), (u'GEN_MISC_FEATURE_A', u'GDB1'), (u'GEN_MISC_FEATURE_P', u'GDB1'), (u'GEODETIC_POINT_P', u'GDB1'), (u'GEOGRAPHIC_INFO_PT_A', u'GDB1'), (u'GEOGRAPHIC_INFO_PT_L', u'GDB1'), (u'GEOGRAPHIC_INFO_PT_P', u'GDB1'), (u'GEOMORPH_LINE_L', u'GDB1'), (u'GEOMORPH_LOC_A', u'GDB1'), (u'GEOMORPH_LOC_P', u'GDB1'), (u'GEOPHYSICAL_GRID_L', u'GDB1'), (u'GEOTHERMAL_FEATURE_P', u'GDB1'), (u'GLACIER_A', u'GDB1'), (u'GOLF_COURSE_A', u'GDB1'), (u'GOLF_COURSE_P', u'GDB1'), (u'GOLF_DRIVING_RANGE_A', u'GDB1'), (u'GRAIN_BIN_SILO_A', u'GDB1'), (u'GRAIN_BIN_SILO_P', u'GDB1'), (u'GRAIN_ELEVATOR_A', u'GDB1'), (u'GRAIN_ELEVATOR_P', u'GDB1'), (u'GRANDSTAND_A', u'GDB1'), (u'GRASSLAND_A', u'GDB1'), (u'GRIDIRON_A', u'GDB1'), (u'GROIN_A', u'GDB1'), (u'GROIN_L', u'GDB1'), (u'GROUND_SURF_ELEM_A', u'GDB1'), (u'GULLY_GORGE_A', u'GDB1'), (u'GULLY_GORGE_L', u'GDB1'), (u'HARBOR_A', u'GDB1'), (u'HEDGEROW_L', u'GDB1'), (u'HELIPORT_A', u'GDB1'), (u'HELIPORT_P', u'GDB1'), (u'HELI_LANDING_PAD_A', u'GDB1'), (u'HELI_LANDING_PAD_P', u'GDB1'), (u'HOPPER_P', u'GDB1'), (u'HOPS_A', u'GDB1'), (u'HUMMOCK_A', u'GDB1'), (u'ICE_CLIFF_L', u'GDB1'), (u'ICE_PEAK_NUNATAK_P', u'GDB1'), (u'ICE_SHELF_A', u'GDB1'), (u'INLAND_SHORELINE_L', u'GDB1'), (u'INLAND_WATER_A', u'GDB1'), (u'INLAND_WATER_ELEV_A', u'GDB1'), (u'INLAND_WATER_ELEV_P', u'GDB1'), (u'INTERCHANGE_L', u'GDB1'), (u'INTERCHANGE_P', u'GDB1'), (u'INTL_DATE_LINE_L', u'GDB1'), (u'ISLAND_A', u'GDB1'), (u'ISLAND_P', u'GDB1'), (u'JETTY_A', u'GDB1'), (u'JETTY_L', u'GDB1'), (u'KELP_SEAWEED_A', u'GDB1'), (u'LAGOON_REEF_POOL_A', u'GDB1'), (u'LANDING_PLACE_A', u'GDB1'), (u'LAND_DEVOID_OF_VEG_A', u'GDB1'), (u'LAND_SUB_INUNDATE_A', u'GDB1'), (u'LAUNCH_PAD_P', u'GDB1'), (u'LEADING_LINE_L', u'GDB1'), (u'LIGHTHOUSE_A', u'GDB1'), (u'LIGHTHOUSE_P', u'GDB1'), (u'LIGHT_L', u'GDB1'), (u'LIGHT_P', u'GDB1'), (u'LIGHT_SECTOR_A', u'GDB1'), (u'LIGHT_SECTOR_P', u'GDB1'), (u'LIGHT_STANDARD_P', u'GDB1'), (u'PROCESSING_PLANT_A', u'GDB1'), (u'PROCESSING_PLANT_L', u'GDB1'), (u'PROCESSING_PLANT_P', u'GDB1'), (u'PUMPING_STATION_A', u'GDB1'), (u'PUMPING_STATION_P', u'GDB1'), (u'QUARRY_A', u'GDB1'), (u'QUARRY_P', u'GDB1'), (u'RACE_TRACK_A', u'GDB1'), (u'RACE_TRACK_L', u'GDB1'), (u'RACE_TRACK_P', u'GDB1'), (u'RADAR_TRANSMITTER_A', u'GDB1'), (u'RADAR_TRANSMITTER_P', u'GDB1'), (u'RAILROAD_L', u'GDB1'), (u'RAILROAD_TURNTABLE_A', u'GDB1'), (u'RAILROAD_TURNTABLE_P', u'GDB1'), (u'RAMP_A', u'GDB1'), (u'RAMP_MARITIME_A', u'GDB1'), (u'RAMP_MARITIME_L', u'GDB1'), (u'RAMP_MARITIME_P', u'GDB1'), (u'RAMP_P', u'GDB1'), (u'RAPIDS_A', u'GDB1'), (u'RAPIDS_L', u'GDB1'), (u'RAPIDS_P', u'GDB1'), (u'REEF_A', u'GDB1'), (u'REEF_L', u'GDB1'), (u'RESERVOIR_A', u'GDB1'), (u'RESERVOIR_P', u'GDB1'), (u'RESTRICTED_AREA_A', u'GDB1'), (u'RESTRICTED_AREA_L', u'GDB1'), (u'REVETMENT_A', u'GDB1'), (u'REVETMENT_L', u'GDB1'), (u'RICE_FIELD_A', u'GDB1'), (u'RIDGE_LINE_L', u'GDB1'), (u'RIG_SUPERSTRUCTURE_P', u'GDB1'), (u'RIVER_STREAM_A', u'GDB1'), (u'RIVER_VANISH_POINT_P', u'GDB1'), (u'ROAD_L', u'GDB1'), (u'ROCK_A', u'GDB1'), (u'ROCK_L', u'GDB1'), (u'ROCK_P', u'GDB1'), (u'ROCK_STRATA_A', u'GDB1'), (u'ROCK_STRATA_P', u'GDB1'), (u'ROUTE_MARITIME_A', u'GDB1'), (u'ROUTE_MARITIME_L', u'GDB1'), (u'ROUTE_MARKER_P', u'GDB1'), (u'RR_MARSHAL_YARD_A', u'GDB1'), (u'RR_MARSHAL_YARD_L', u'GDB1'), (u'RR_MARSHAL_YARD_P', u'GDB1'), (u'RR_SIDING_SPUR_L', u'GDB1'), (u'RUINS_A', u'GDB1'), (u'RUINS_P', u'GDB1'), (u'RUNWAY_A', u'GDB1'), (u'RUNWAY_L', u'GDB1'), (u'RUNWAY_P', u'GDB1'), (u'SALT_EVAPORATOR_A', u'GDB1'), (u'SALT_PAN_A', u'GDB1'), (u'SAND_DUNE_HILLS_A', u'GDB1'), (u'SEAPLANE_BASE_A', u'GDB1'), (u'SEAPLANE_BASE_P', u'GDB1'), (u'SEAWALL_A', u'GDB1'), (u'SEAWALL_L', u'GDB1'), (u'SEBKHA_A', u'GDB1'), (u'SETTLEMENT_A', u'GDB1'), (u'SETTLEMENT_P', u'GDB1'), (u'SETTLING_BASIN_A', u'GDB1'), (u'SHANTY_TOWN_A', u'GDB1'), (u'SHARP_CURVES_P', u'GDB1'), (u'SHED_A', u'GDB1'), (u'SHED_L', u'GDB1'), (u'SHED_P', u'GDB1'), (u'SHORELINE_L', u'GDB1'), (u'SKI_JUMP_L', u'GDB1'), (u'SKI_JUMP_P', u'GDB1'), (u'SLIPWAY_A', u'GDB1'), (u'SLIPWAY_L', u'GDB1'), (u'SLIPWAY_P', u'GDB1'), (u'SLOPE_POLYGON_A', u'GDB1'), (u'SLUICE_GATE_L', u'GDB1'), (u'SLUICE_GATE_P', u'GDB1'), (u'SNOW_ICE_FIELD_A', u'GDB1'), (u'SNOW_ROCK_SHED_A', u'GDB1'), (u'SNOW_ROCK_SHED_L', u'GDB1'), (u'SNOW_ROCK_SHED_P', u'GDB1'), (u'SOLAR_PANELS_P', u'GDB1'), (u'SOUNDING_P', u'GDB1'), (u'SPILLWAY_A', u'GDB1'), (u'SPILLWAY_L', u'GDB1'), (u'SPOT_ELEVATION_P', u'GDB1'), (u'SPRING_WATER_HOLE_P', u'GDB1'), (u'STADIUM_AMPHI_A', u'GDB1'), (u'STADIUM_AMPHI_P', u'GDB1'), (u'STATION_MISC_A', u'GDB1'), (u'STATION_MISC_L', u'GDB1'), (u'STATION_MISC_P', u'GDB1'), (u'STORAGE_BUNKER_A', u'GDB1'), (u'STORAGE_BUNKER_P', u'GDB1'), (u'STORM_DRAIN_L', u'GDB1'), (u'SUBSTATION_A', u'GDB1'), (u'SUBSTATION_P', u'GDB1'), (u'SUBWAY_L', u'GDB1'), (u'SWAMP_A', u'GDB1'), (u'SWIMMING_POOL_A', u'GDB1'), (u'TANK_A', u'GDB1'), (u'TANK_P', u'GDB1'), (u'TAXIWAY_A', u'GDB1'), (u'TAXIWAY_L', u'GDB1'), (u'TELEPHONE_LINE_L', u'GDB1'), (u'TELEPHONE_PYLON_P', u'GDB1'), (u'TENNIS_COURTS_A', u'GDB1'), (u'TENT_DWELLINGS_A', u'GDB1'), (u'TENT_DWELLINGS_P', u'GDB1'), (u'TEST_AREA_A', u'GDB1'), (u'TEXT_DESCRIPTION_A', u'GDB1'), (u'TEXT_DESCRIPTION_L', u'GDB1'), (u'TEXT_DESCRIPTION_P', u'GDB1'), (u'TIDE_DATA_POINT_P', u'GDB1'), (u'TIDE_GAUGE_P', u'GDB1'), (u'TIMBER_YARD_A', u'GDB1'), (u'TOWER_NONCOMM_P', u'GDB1'), (u'TRAFFIC_SEP_SCHEME_A', u'GDB1'), (u'TRAFFIC_SEP_SCHEME_L', u'GDB1'), (u'TRAFFIC_SEP_SCHEME_P', u'GDB1'), (u'TRAINING_AREA_A', u'GDB1'), (u'TREES_L', u'GDB1'), (u'TREES_P', u'GDB1'), (u'TRENCH_L', u'GDB1'), (u'TUNDRA_A', u'GDB1'), (u'TUNNEL_L', u'GDB1'), (u'TUNNEL_P', u'GDB1'), (u'UNDERGROUND_BUNKER_A', u'GDB1'), (u'UNDERGROUND_BUNKER_L', u'GDB1'), (u'UNDERGROUND_BUNKER_P', u'GDB1'), (u'UNDERGROUND_DWELL_P', u'GDB1'), (u'UNDERWATER_DANGER_A', u'GDB1'), (u'UNDERWATER_DANGER_L', u'GDB1'), (u'UNDERWATER_DANGER_P', u'GDB1'), (u'VEHICLE_REST_AREA_A', u'GDB1'), (u'VEHICLE_REST_AREA_P', u'GDB1'), (u'VEHICLE_STORAGE_A', u'GDB1'), (u'VINEYARDS_A', u'GDB1'), (u'VOID_COLLECT_AREA_A', u'GDB1'), (u'VOLCANIC_DIKE_L', u'GDB1'), (u'VOLCANO_A', u'GDB1'), (u'VOLCANO_P', u'GDB1'), (u'WALL_L', u'GDB1'), (u'WATERFALL_L', u'GDB1'), (u'WATERFALL_P', u'GDB1'), (u'WATER_EXCPT_INLAND_A', u'GDB1'), (u'WATER_INTAKE_TOWER_A', u'GDB1'), (u'WATER_INTAKE_TOWER_P', u'GDB1'), (u'WATER_TOWER_A', u'GDB1'), (u'WATER_TOWER_P', u'GDB1'), (u'WELL_P', u'GDB1'), (u'WINDMILL_P', u'GDB1'), (u'WINDMOTOR_P', u'GDB1'), (u'WRECKING_YARD_A', u'GDB1'), (u'WRECK_A', u'GDB1'), (u'WRECK_P', u'GDB1'), (u'ZOO_SAFARI_PARK_A', u'GDB1')]
        self.assertEqual(base_layers_to_keep, oracle_worker.get_layers(job))

    def test_one_layer(self):
        """Test one layer is returned for indexing."""
        job = base_job.Job(os.path.join(os.getcwd(), 'one_layer_oracle.json'))
        job.connect_to_database()
        self.assertEqual([(u'COUNTRY', u'GDB1')], oracle_worker.get_layers(job))

    def test_layers_to_keep_wildcard(self):
        """Test layers using wildcards."""
        job = base_job.Job(os.path.join(os.getcwd(), 'layers_wildcards_oracle.json'))
        job.connect_to_database()
        self.assertEqual([(u'LOCK_A', u'GDB1'), (u'LOCK_L', u'GDB1')], sorted(oracle_worker.get_layers(job)))
